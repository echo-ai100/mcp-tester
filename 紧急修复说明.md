# 🚨 MCP Tester 紧急修复说明

## 当前状态

我已经在代码中添加了详细的调试日志，并生成了调试版本的VSIX包。现在需要你的帮助来诊断问题的真正原因。

## 📦 立即安装调试版

### 文件信息
- **文件名**：`mcp-tester-0.0.2-debug.vsix`
- **大小**：4.0 MB
- **特点**：包含详细的Console调试日志

### 安装步骤（重要！）

1. **卸载旧版本**（如果已安装）
   - VSCode扩展面板 → 找到MCP Tester → 卸载
   - 重启VSCode

2. **安装调试版**
   - 按 `Cmd+Shift+P`
   - 输入：`Extensions: Install from VSIX...`
   - 选择：`mcp-tester-0.0.2-debug.vsix`
   - **重启VSCode**

3. **打开开发者工具**（必须！）
   - 按 `Cmd+Option+I` (macOS) 或 `Ctrl+Shift+I` (Windows)
   - 切换到 **Console** 标签页
   - 保持开发者工具打开

## 🔍 诊断步骤

### 步骤1：打开MCP Tester并连接服务器
正常操作，连接到你的MCP服务器

### 步骤2：切换到提示词标签页
查看提示词列表是否正常显示

### 步骤3：点击有参数的提示词的"获取"按钮

**关键！** 点击后立即查看Console输出，你会看到类似这样的日志：

```javascript
[PromptsTab] handleGetPromptClick called
[PromptsTab] prompt: {
  "name": "your-prompt-name",
  "description": "...",
  "arguments": [...]
}
[PromptsTab] prompt.arguments: [...]
[PromptsTab] arguments length: X
```

### 步骤4：判断问题类型

#### 情况A：看到 `[PromptsTab] 显示参数输入框` 和 `showArgsModal set to true`
**说明**：代码逻辑正确，但弹窗没有显示
**可能原因**：
- CSS问题
- DOM渲染问题
- Vue响应性问题

**请提供**：
1. 完整的Console日志
2. 截图显示弹窗是否出现
3. 在Elements标签页搜索 `showArgsModal`，查看DOM元素

#### 情况B：看到 `[PromptsTab] 无参数，直接获取提示词`
**说明**：`prompt.arguments` 为空或不存在
**可能原因**：
- 服务器返回的提示词结构不正确
- 参数字段名称不匹配

**请提供**：
1. 完整的 `prompt` 对象JSON（从Console复制）
2. MCP服务器的类型和命令
3. 提示词的实际定义（服务器端代码）

#### 情况C：根本没有看到任何 `[PromptsTab]` 日志
**说明**：点击事件没有触发
**可能原因**：
- 按钮被禁用
- 事件绑定失败
- WebView通信问题

**请检查**：
1. 按钮是否为灰色（禁用状态）
2. Console是否有其他错误（红色文字）
3. 尝试刷新WebView

## 📋 需要你提供的信息

为了彻底解决问题，我需要以下信息（请完整复制）：

### 1. Console完整日志
```
（从开发者工具Console标签页复制所有 [PromptsTab] 开头的日志）
```

### 2. Prompt对象结构
```javascript
（复制Console中显示的完整 prompt 对象JSON）
```

### 3. 错误信息（如果有）
```
（复制所有红色的错误信息）
```

### 4. 你的MCP服务器配置
```json
{
  "type": "stdio/sse/http",
  "command": "...",
  "args": [...],
  "url": "..."
}
```

### 5. 现象描述
- [ ] 点击"获取"按钮后，弹窗有显示吗？
- [ ] 如果有显示，是否有输入框？
- [ ] 如果没有显示，Console有什么日志？
- [ ] 是否直接报错？错误信息是什么？

## 🎯 快速测试

如果你想快速测试Vue组件是否正常，可以在Console中执行：

```javascript
// 测试1：检查showArgsModal是否可以被设置
console.log('Testing showArgsModal...')

// 测试2：查看当前prompts数据
console.log('Current prompts:', prompts)

// 测试3：查看是否有选中的prompt
console.log('Selected prompt:', selectedPrompt)
```

## 💡 可能的根本原因猜测

基于你的描述"点击获取按钮时没有弹出输入参数的弹窗"，我怀疑可能是以下原因之一：

### 假设1：服务器返回的arguments字段格式不对
MCP协议要求 `arguments` 应该是一个数组，每个元素包含：
```json
{
  "name": "参数名",
  "description": "参数说明",
  "required": true/false
}
```

如果服务器返回的格式不同，判断条件会失败。

### 假设2：WebView缓存问题
有时候WebView会缓存旧版本的代码。
**解决方案**：
1. 完全卸载扩展
2. 重启VSCode
3. 重新安装调试版
4. 硬刷新WebView（Cmd+Shift+R）

### 假设3：Vue响应性问题
`showArgsModal` 可能没有正确触发视图更新。
**诊断方法**：在Console中手动设置后观察。

## 🚀 下一步

1. ✅ 安装 `mcp-tester-0.0.2-debug.vsix`
2. ✅ 打开开发者工具
3. ✅ 点击有参数的提示词的"获取"按钮
4. ✅ 复制Console中的所有 `[PromptsTab]` 日志
5. ✅ 提供上述所有诊断信息

收到诊断信息后，我将能够：
- 准确定位问题
- 提供精确的修复
- 生成最终稳定版本

---

**紧急联系**：请尽快提供Console日志，我随时待命帮你解决！
**调试版本**：mcp-tester-0.0.2-debug.vsix  
**生成时间**：2025-10-25 23:09
